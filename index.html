<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" /><link rel="canonical" href="https://github.com/pprados/virtual_dataframe/" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>virtual_dataframe</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Home";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = "/pprados/virtual_dataframe/";
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> virtual_dataframe
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href=".">Home</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="cluster/">Cluster</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="install/">Install</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="compatibility/">Compatibility</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="api/">API</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="best_practices/">Best Practice</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="test/">Test</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="bench/">Bench</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="faq/">FAQ</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Contribute</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="tech/">Tech</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="contribute/">Contribute</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="commands/">Commands</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="CHANGELOG/">Changelog</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">virtual_dataframe</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Home</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/pprados/virtual_dataframe/edit/master/docs/index.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="motivation">Motivation</h2>
<p>With Panda-like dataframe or numby-like array, do you want to create a code, and choose at the end, the framework
to use?  Do you want to be able to choose the best framework after simply performing performance measurements?
This framework unifies multiple Panda-compatible or Numpy-comptaible components,
to allow the writing of a single code, compatible with all.</p>
<p>This project will <em>weave</em> your code with the selected framework, at runtime.</p>
<h2 id="synopsis">Synopsis</h2>
<p>With some parameters and Virtual classes, it's possible to write a code, and execute this code:</p>
<ul>
<li>With or without multicore</li>
<li>With or without cluster (multi nodes on Dask or Spark)</li>
<li>With or without GPU</li>
</ul>
<p>To do that, we create some virtual classes, add some methods in others classes, etc.</p>
<p>To reduce the confusion, you must use the classes <code>VDataFrame</code> and <code>VSeries</code> (The prefix <code>V</code> is for <em>Virtual</em>).
These classes propose the methods <code>.to_pandas()</code> and <code>.compute()</code> for each version, but are the <em>real</em> classes
of the selected framework.</p>
<p>With some parameters, the real classes may be <code>pandas.DataFrame</code>, <code>modin.pandas.DataFrame</code>,
<code>cudf.DataFrame</code>,
<code>pyspark.pandas.DataFrame</code> without GPU,
<code>pyspark.pandas.DataFrame</code> with GPU,
<code>dask.dataframe.DataFrame</code> with Pandas or
<code>dask.dataframe.DataFrame</code> with cudf (with Pandas or cudf for each partition).</p>
<p>Or, for Numpy, the real classes may be <code>numpy.ndarray</code>, <code>cupy.ndarray</code> or <code>dask.array</code>.</p>
<p>A new <code>@delayed</code> annotation can be use, with or without Dask.</p>
<p>To manage the initialisation of a Dask ou Spark, you must use the <code>VClient()</code>,
a connector to the cluster.
This alias, can be automatically initialized with some environment variables.</p>
<pre><code class="language-python"># Sample of code, compatible Pandas, cudf, dask, dask_modin and dask_cudf
from virtual_dataframe import *

TestDF = VDataFrame

with (VClient()):
    @delayed
    def my_function(data: TestDF) -&gt; TestDF:
        return data


    rc = my_function(VDataFrame({&quot;data&quot;: [1, 2]}, npartitions=2))
    print(rc.to_pandas())

</code></pre>
<p>With this framework, you can select your environment, to run or debug your code.</p>
<table>
<thead>
<tr>
<th>env</th>
<th>Environement</th>
</tr>
</thead>
<tbody>
<tr>
<td>VDF_MODE=pandas</td>
<td>Only Python with classical pandas</td>
</tr>
<tr>
<td>VDF_MODE=numpy</td>
<td>Alias of <code>pandas</code></td>
</tr>
<tr>
<td>VDF_MODE=cudf</td>
<td>Python with local cuDF (GPU)</td>
</tr>
<tr>
<td>VDF_MODE=cupy</td>
<td>Alias of cudf</td>
</tr>
<tr>
<td>VDF_MODE=dask</td>
<td>Dask with local multiple process and pandas</td>
</tr>
<tr>
<td>VDF_MODE=dask_array</td>
<td>Alias of <code>dask</code></td>
</tr>
<tr>
<td>VDF_MODE=dask_cudf</td>
<td>Dask with local multiple process and cuDF</td>
</tr>
<tr>
<td>VDF_MODE=dask<br />DEBUG=True</td>
<td>Dask with single thread and pandas</td>
</tr>
<tr>
<td>VDF_MODE=dask_cudf<br />DEBUG=True</td>
<td>Dask with single thread and cuDF</td>
</tr>
<tr>
<td>VDF_MODE=dask<br />VDF_CLUSTER=dask://.local</td>
<td>Dask with local cluster and pandas</td>
</tr>
<tr>
<td>VDF_MODE=dask_cudf<br />VDF_CLUSTER=dask://.local</td>
<td>Dask with local cuda cluster and cuDF</td>
</tr>
<tr>
<td>VDF_MODE=dask<br />VDF_CLUSTER=dask://...:ppp</td>
<td>Dask with remote cluster and Pandas</td>
</tr>
<tr>
<td>VDF_MODE=dask_cudf<br />VDF_CLUSTER=dask://...:ppp</td>
<td>Dask with remote cluster and cuDF</td>
</tr>
<tr>
<td>VDF_MODE=dask_modin<br /></td>
<td>Dask with modin</td>
</tr>
<tr>
<td>VDF_MODE=dask_modin<br />VDF_CLUSTER=dask://.local</td>
<td>Dask with local cluster and modin</td>
</tr>
<tr>
<td>VDF_MODE=dask_modin<br />VDF_CLUSTER=dask://...:ppp</td>
<td>Dask with remote cluster and modin</td>
</tr>
<tr>
<td>VDF_MODE=pyspark<br />VDF_CLUSTER=spark://.local</td>
<td>PySpark with local cluster and modin</td>
</tr>
<tr>
<td>VDF_MODE=pyspark<br />VDF_CLUSTER=spark://...:ppp</td>
<td>PySpark with remote cluster and modin</td>
</tr>
</tbody>
</table>
<p><em>For pyspark with GPU, read <a href="cluster/">this</a>.</em></p>
<p>The real compatibilty between the differents simulation of Pandas, depends on the implement of the modin, cudf, pyspark
or dask. Sometime, you can use the <code>VDF_MODE</code> variable, to update some part of code, between
the selected backend.</p>
<p>It's not always easy to write a code <em>compatible</em> with all scenario, but it's possible.
Generally, add just <code>.compute()</code> and/or <code>.to_pandas()</code> at the end of the ETL, is enough.
But, you must use, only the common feature with all frameworks.</p>
<p>After this effort, it's possible to compare the performance about the differents technologies,
or propose a component, compatible with differents scenario.</p>
<p>For the deployment of your project, you can select the best framework for your process
(in a dockerfile? or virtual environment),
with only one ou two environment variables.
May be, you can use <em>Modin</em> all the time, except for the end of the year periods, when the use of a GPU is preferable.</p>
<p>With conda environment, you can use <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#setting-environment-variables">variables</a>
to set the variables when you <em>activate</em> an environment.</p>
<p><a href="https://mybinder.org/v2/gh/pprados/virtual-dataframe?labpath=%2Fmain%2Fnotebooks"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<h1 id="alternative">Alternative</h1>
<ul>
<li>The projet <a href="https://fugue-tutorials.readthedocs.io/">Fugue</a> propose another approch
to distribute a job with Spark, Dask or Ray.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="cluster/" class="btn btn-neutral float-right" title="Cluster">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/pprados/virtual_dataframe" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
      <span><a href="cluster/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.4.2
Build Date UTC : 2023-02-09 10:24:18.153367+00:00
-->
